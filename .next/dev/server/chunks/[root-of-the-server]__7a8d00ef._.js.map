{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahmu/OneDrive/Desktop/simonetti-hybrid/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey)\n\n// For server-side operations with elevated privileges\nexport const supabaseAdmin = createClient(\n  supabaseUrl,\n  process.env.SUPABASE_SERVICE_ROLE_KEY || supabaseAnonKey\n)\n"],"names":[],"mappings":";;;;;;AAAA;;;;;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,yRAAY,EAAC,aAAa;AAG3C,MAAM,gBAAgB,IAAA,yRAAY,EACvC,aACA,QAAQ,GAAG,CAAC,yBAAyB,IAAI"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/mahmu/OneDrive/Desktop/simonetti-hybrid/pages/api/favorites.ts"],"sourcesContent":["import type { NextApiRequest, NextApiResponse } from 'next'\nimport { supabase } from '@/lib/supabase'\n\nexport default async function handler(\n  req: NextApiRequest,\n  res: NextApiResponse\n) {\n  // Get user from auth header\n  const authHeader = req.headers.authorization\n  if (!authHeader) {\n    return res.status(401).json({ error: 'Unauthorized' })\n  }\n\n  const token = authHeader.replace('Bearer ', '')\n  const { data: { user }, error: authError } = await supabase.auth.getUser(token)\n\n  if (authError || !user) {\n    return res.status(401).json({ error: 'Unauthorized' })\n  }\n\n  if (req.method === 'GET') {\n    try {\n      const { data, error } = await supabase\n        .from('favorites')\n        .select(`\n          id,\n          product_id,\n          products (*)\n        `)\n        .eq('user_id', user.id)\n\n      if (error) throw error\n\n      res.status(200).json({ favorites: data })\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || 'Failed to fetch favorites' })\n    }\n  } else if (req.method === 'POST') {\n    try {\n      const { product_id } = req.body\n\n      const { data, error } = await supabase\n        .from('favorites')\n        .insert({\n          user_id: user.id,\n          product_id,\n        })\n        .select()\n        .single()\n\n      if (error) throw error\n\n      res.status(200).json({ favorite: data })\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || 'Failed to add favorite' })\n    }\n  } else if (req.method === 'DELETE') {\n    try {\n      const { product_id } = req.query\n\n      const { error } = await supabase\n        .from('favorites')\n        .delete()\n        .eq('user_id', user.id)\n        .eq('product_id', product_id)\n\n      if (error) throw error\n\n      res.status(200).json({ success: true })\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || 'Failed to remove favorite' })\n    }\n  } else {\n    res.status(405).json({ error: 'Method not allowed' })\n  }\n}\n"],"names":[],"mappings":";;;;AACA;;;;;;AAEe,eAAe,QAC5B,GAAmB,EACnB,GAAoB;IAEpB,4BAA4B;IAC5B,MAAM,aAAa,IAAI,OAAO,CAAC,aAAa;IAC5C,IAAI,CAAC,YAAY;QACf,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAe;IACtD;IAEA,MAAM,QAAQ,WAAW,OAAO,CAAC,WAAW;IAC5C,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,EAAE,OAAO,SAAS,EAAE,GAAG,MAAM,kKAAQ,CAAC,IAAI,CAAC,OAAO,CAAC;IAEzE,IAAI,aAAa,CAAC,MAAM;QACtB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAe;IACtD;IAEA,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,IAAI;YACF,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,kKAAQ,CACnC,IAAI,CAAC,aACL,MAAM,CAAC,CAAC;;;;QAIT,CAAC,EACA,EAAE,CAAC,WAAW,KAAK,EAAE;YAExB,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,WAAW;YAAK;QACzC,EAAE,OAAO,OAAY;YACnB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO,IAAI;YAA4B;QAC7E;IACF,OAAO,IAAI,IAAI,MAAM,KAAK,QAAQ;QAChC,IAAI;YACF,MAAM,EAAE,UAAU,EAAE,GAAG,IAAI,IAAI;YAE/B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,kKAAQ,CACnC,IAAI,CAAC,aACL,MAAM,CAAC;gBACN,SAAS,KAAK,EAAE;gBAChB;YACF,GACC,MAAM,GACN,MAAM;YAET,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,UAAU;YAAK;QACxC,EAAE,OAAO,OAAY;YACnB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO,IAAI;YAAyB;QAC1E;IACF,OAAO,IAAI,IAAI,MAAM,KAAK,UAAU;QAClC,IAAI;YACF,MAAM,EAAE,UAAU,EAAE,GAAG,IAAI,KAAK;YAEhC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,kKAAQ,CAC7B,IAAI,CAAC,aACL,MAAM,GACN,EAAE,CAAC,WAAW,KAAK,EAAE,EACrB,EAAE,CAAC,cAAc;YAEpB,IAAI,OAAO,MAAM;YAEjB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,SAAS;YAAK;QACvC,EAAE,OAAO,OAAY;YACnB,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO,IAAI;YAA4B;QAC7E;IACF,OAAO;QACL,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAqB;IACrD;AACF"}}]
}